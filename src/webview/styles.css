@tailwind base;
@tailwind components;
@tailwind utilities;

/* shadcn/ui のためのCSS変数 (VSCodeのテーマに合わせる) */
:root {
  --background: var(--vscode-sideBar-background);
  --foreground: var(--vscode-foreground);

  --card: var(--vscode-input-background);
  --card-foreground: var(--vscode-input-foreground);

  --popover: var(--vscode-menu-background);
  --popover-foreground: var(--vscode-menu-foreground);

  --primary: var(--vscode-button-background);
  --primary-foreground: var(--vscode-button-foreground);

  --secondary: var(--vscode-button-secondaryBackground);
  --secondary-foreground: var(--vscode-button-secondaryForeground);

  --muted: var(
    --vscode-disabledForeground
  ); /* VSCodeに直接対応するものがないため、近い色を割り当て */
  --muted-foreground: var(--vscode-disabledForeground);

  --accent: var(--vscode-focusBorder); /* フォーカス色をアクセントに */
  --accent-foreground: var(--vscode-foreground);

  --destructive: var(--vscode-errorForeground);
  --destructive-foreground: var(--vscode-foreground); /* エラー時のテキスト色（適宜調整）*/

  --border: var(--vscode-input-border);
  --input: var(--vscode-input-border);
  --ring: var(--vscode-focusBorder);

  --radius: 0.5rem;
}

/* ▼▼▼ 1. 全体のレイアウトと余白の修正 ▼▼▼ */
html,
body {
  height: 100%;
  margin: 0;
  padding: 0;
  overflow: hidden;
}

/* bodyに勝手につくpaddingを打ち消す */
body[style] {
  padding-right: 0 !important;
}

#root {
  height: 100%;
  width: 100%;
  overflow-y: auto;
  overflow-x: hidden;
  position: relative;

  /* ★重要: ここでサイドバー全体の「左右の隙間」を作ります */
  padding: 20px 10px;
  box-sizing: border-box; /* paddingを含めたサイズ計算にする */
}

/* スクロールバーのデザイン調整（前回の内容を維持） */
#root::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}
#root::-webkit-scrollbar-thumb {
  background-color: var(--vscode-scrollbarSlider-background);
  border-radius: 5px;
  border: 2px solid transparent;
  background-clip: content-box;
}
#root::-webkit-scrollbar-thumb:hover {
  background-color: var(--vscode-scrollbarSlider-hoverBackground);
}
#root::-webkit-scrollbar-thumb:active {
  background-color: var(--vscode-scrollbarSlider-activeBackground);
}

/* ▼▼▼ 追加: 中央揃えと幅調整のための共通設定 ▼▼▼ */
/* 追加ボタン、検索バー、リストを同じ幅で中央に揃える */
.add-button-container,
.search-bar-container,
.snippet-list {
  width: 88%; /* 幅を少し小さく */
  margin-left: auto;
  margin-right: auto;
  max-width: 600px; /* ワイド画面での広がりすぎ防止 */
}

/* ▼▼▼ 2. フォーム（ダイアログ）のデザイン修正 ▼▼▼ */

/* フォーム全体のコンテナ */
.form-container {
  margin-top: 1em;
  border: 1px solid var(--vscode-input-border);
  padding: 1em;
  border-radius: 5px; /* 既存の設定ですが念のため */
}

/* テキスト入力欄のデザイン修正 */
.form-textfield {
  display: block;
  width: 100%;
  box-sizing: border-box;

  /* ★追加: 入力欄自体の角を丸める */
  border-radius: 4px;
}

/* フォーム内のグループ選択ボックス */
.form-select {
  /* ... (既存のプロパティ) ... */
  border-radius: 4px; /* ★追加: 角丸 */
}

/* ▼▼▼ 3. ダイアログ（Modal）のコンテンツ自体のスタイル調整 ▼▼▼ */
/* dialog.tsx で定義されているクラスに対応するCSS調整 */

/* ダイアログの中身（白い箱部分） */
[data-state="open"] .fixed.z-50.grid {
  /* ★追加: ダイアログの角を丸くする */
  border-radius: 8px !important;

  /* ★追加: ダイアログの内側に余白を持たせる */
  padding: 24px !important;

  /* ★追加: ダイアログの左右にも少し余裕を持たせる（画面幅いっぱいにならないように） */
  max-width: calc(100% - 40px) !important;
}

/* スニペットリスト全体のコンテナ */
.snippet-list {
  display: flex;
  flex-direction: column;
  gap: 0.5em;
  margin-bottom: 1em;
}

/* ▼▼▼【修正】グループ内のスニペットを右にずらして階層を表現 ▼▼▼ */
.group-snippets {
  padding-left: 20px;
  display: flex;
  flex-direction: column;
  gap: 6px;
  margin-top: 4px;
}

/* 検索バーのコンテナ */
.search-bar-container {
  margin-top: 8px;
  margin-bottom: 8px;
}

/* スニペット追加ボタンとドロップダウンのコンテナ */
.add-button-container {
  display: flex;
  align-items: stretch;
}

/* 「スニペットを追加する」ボタン本体 */
.add-button {
  flex-grow: 1; /* 残りのスペースを埋める */
  width: auto;
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
  border-right: none;
  text-align: left;
}

/* ドロップダウンを開くボタン */
.add-dropdown-button {
  height: auto;
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
  border-left: 1px solid var(--vscode-button-border, var(--vscode-input-border));
}

/* ドロップダウンメニュー本体 */
.add-dropdown-menu {
  position: absolute;
  top: 100%;
  right: 0;
  z-index: 10;
  display: flex;
  flex-direction: column;
  width: auto;
  background: var(--vscode-menu-background);
  border: 1px solid var(--vscode-menu-border);
  box-shadow: var(--vscode-menu-shadow);
  padding: 4px 8px;
  margin-top: 2px;
  border-radius: 3px;
}

/* スニペット一行全体のコンテナ */
.snippet-item,
.group-header {
  position: relative; /* 絶対配置の基準点 */
  display: flex;
  align-items: center;
  /* gapは削除（ハンドルが浮くため） */
}

/* ▼▼▼ 追加: グループヘッダーはクリックで開閉するためポインターを表示 ▼▼▼ */
.group-header {
  cursor: pointer;
}
/* ▲▲▲ 追加ここまで ▲▲▲ */

/* スニペット名を表示するボタン */
.snippet-name-button {
  width: 100%;
  flex-grow: 1; /* スペースを埋めて右端にメニューを配置 */
  text-align: left;
}

/* グループ名 */
.group-header .group-name {
  flex-grow: 1;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  /* 左padding不要（ハンドルが外に出るため、左端が揃う） */
}

.non-grouped-container {
  /* スニペットリストの基本的なスタイル（縦並びと間隔）を維持 */
  display: flex;
  flex-direction: column;
  /* 親の.snippet-listのgap (0.5em) をここで再定義して間隔を維持 */
  gap: 0.5em;
}

/* フォーム全体のコンテナ */
.form-container {
  margin-top: 1em;
  border: 1px solid var(--vscode-input-border);
  padding: 1em;
  border-radius: 5px;
}

/* ラベル、入力欄、エラーをまとめるグループ */
.form-group {
  margin-bottom: 0.8em;
}

/* テキスト入力欄 */
.form-textfield {
  display: block;
  width: 100%;
  box-sizing: border-box;
}

/* 検索バーの入力欄 */
.search-input {
  width: 100%;
  box-sizing: border-box; /* paddingを含めてwidthを100%に */
  border-radius: 4px;
}

/* グループ選択のセレクトボックス */
.form-select {
  display: block;
  width: 100%;
  margin-bottom: 0.5em;
  background-color: var(--vscode-input-background);
  color: var(--vscode-input-foreground);
  border: 1px solid var(--vscode-input-border);
  border-radius: 2px;
  padding: 0.4em;
  font-size: 1em;
  font-family: inherit;
  outline: none;
  box-sizing: border-box;
}

/* セレクトボックスがフォーカスされた時のスタイル */
.form-select:focus {
  border-color: var(--vscode-focusBorder);
  box-shadow: 0 0 0 1px var(--vscode-focusBorder);
}

/* 複数コマンド入力のコンテナ */
.command-input-container {
  display: flex;
  align-items: center;
  margin-bottom: 4px;
  margin-top: 0;
  width: 100%;
}

.command-input-container .form-textfield {
  flex-grow: 1;
}

/* コマンド削除ボタン */
.command-input-container .remove-command-button {
  margin-left: 5px;
  min-width: 24px !important;
  max-width: 24px !important;
  width: 24px !important;
  height: 24px !important;
  padding: 0 !important;
  display: flex !important;
  align-items: center;
  justify-content: center;
  flex-shrink: 0 !important;
  flex-grow: 0 !important;
  background-color: #ffffff; /* 中は白 */
  color: #000000; /* －は黒 */
  border: 1px solid #000000; /* 枠線は黒 */
  border-radius: 50%;
}

/* フォームの登録・更新ボタンのコンテナ */
.form-actions {
  display: flex;
  gap: 0.5em;
  margin-top: 2px;
  justify-content: flex-end;
}

/* バリデーションエラーメッセージ */
.error-message {
  color: var(--vscode-errorForeground);
  font-size: 12px;
  margin-top: 4px;
}

/* ドラッグハンドル */
.drag-handle {
  margin-right: 0; /* マージン不要 */
  color: var(--vscode-foreground);
  opacity: 0.6;
  cursor: grab;

  /* ホバー時の表示制御 */
  visibility: hidden;
  opacity: 0;
  transition: opacity 0.2s, visibility 0.2s;
}

.drag-handle:hover {
  opacity: 1;
}

/* 通常時はドラッグハンドルを非表示に設定 */
.snippet-item .drag-handle,
.group-header .drag-handle {
  visibility: hidden;
  opacity: 0;
  transition: opacity 0.2s ease-in-out, visibility 0.2s ease-in-out;
}

/* 項目にホバーした際にドラッグハンドルを表示 */
.snippet-item:hover .drag-handle,
.group-header:hover .drag-handle {
  visibility: visible;
  opacity: 1;
}

/* ドラッグハンドルとコンテキストメニューのコンテナ */
.drag-handle-container {
  position: absolute;
  left: -24px; /* 親要素の左端より外側(左)に配置 */
  top: 50%;
  transform: translateY(-50%); /* 上下中央揃え */

  display: flex;
  align-items: center;
  justify-content: center;
  width: 20px; /* クリックしやすい幅を確保 */
  height: 100%;
  z-index: 5; /* コンテンツより前面に */
}

/* コンテキストメニューのスタイル */
.context-menu {
  position: absolute;
  top: 80%; /* ハンドルの少し下 */
  left: 0; /* ハンドルの左端に合わせる */
  z-index: 20; /* 最前面 */
  background-color: var(--vscode-dropdown-background);
  border: 1px solid var(--vscode-dropdown-border);
  border-radius: 4px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
  padding: 4px;
  min-width: 80px;
}

/* コンテキストメニューの各項目のスタイル */
.context-menu-item {
  padding: 6px 12px;
  cursor: pointer;
  color: var(--vscode-foreground);
  text-align: center;
}

/* メニュー項目にホバーした時のスタイル */
.context-menu-item:hover {
  background-color: var(--vscode-list-hoverBackground);
}

/* --- VSCodeテーマに合わせたカスタムツールチップ --- */
.custom-tooltip {
  position: fixed;
  padding: 8px 12px;
  background: var(--vscode-editorHoverWidget-background);
  color: var(--vscode-editorHoverWidget-foreground);
  border: 1px solid var(--vscode-editorHoverWidget-border);
  z-index: 999999;
  border-radius: 4px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  max-width: 500px;
  min-width: 200px;
  word-wrap: break-word;
  white-space: normal;
  line-height: 1.4;
}

.tooltip-command-line {
  margin: 2px 0;
  white-space: normal;
  word-break: break-all;
}

.tooltip-wrapper {
  width: 100%;
  display: block;
  position: relative;
}

/* フォームのラベル */
.form-group label {
  display: block; /* 入力欄と縦に並べる */
  margin-bottom: 6px; /* ラベルと入力欄の間の余白 */
  font-size: 14px; /* 入力値より小さく */
  font-weight: 600; /* 太字（強すぎない） */
  color: var(--vscode-foreground);
}

/* チェックボックスコンテナ */
.form-check-container label {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 0;
  font-weight: normal;
  line-height: 1;
}

.form-check-container label span {
  line-height: 1;
  display: flex;
  align-items: center;
}

.form-check-container label [role="checkbox"] {
  margin-top: 0;
  margin-bottom: 0;
  flex-shrink: 0;
}
